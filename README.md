# Proyecto API NIST - Gestión de Vulnerabilidades RETO
Este proyecto es una API desarrollada en **Django** y **Django REST framework** que consulta y gestiona vulnerabilidades desde la **API del NIST (National Institute of Standards and Technology)**. 

Permite listar, marcar como fixeadas, y obtener resúmenes de las vulnerabilidades por nivel de severidad. 

## Requisitos Previos 
### Docker y Docker Compose 

Este proyecto está dockerizado para facilitar su despliegue y ejecución. Necesitas tener instalados **Docker** y **Docker Compose** para ejecutarlo. 
--- 

## Configuración del Proyecto 

### 1. Clonar el repositorio: Primero, clona este repositorio en tu máquina local utilizando Git: `bash git clone https://github.com/tu_usuario/nist-api-repo.git `

> cd nist-api-repo

    
### 2. Configurar la clave de la API del NIST
Este proyecto utiliza la API del NIST para obtener vulnerabilidades, por lo que necesitarás tu **clave API** del NIST. Si no tienes una, puedes registrarte en el [sitio web del NIST](https://nvd.nist.gov/developers/request-an-api-key) y obtenerla.

1. Crea un archivo `.env` en la raiz del proyecto para guardar la key:

> nano .env
2. Dentro del archivo .env, agrega tu calve API del NIST:
> NIST_API_KEY=tu_apiKey_Aqui

Este archivo `.env` será utilizado por Docker para pasar la clave API como una variable de entorno.

## Cómo ejecutar el proyecto

Este proyecto utiliza **Docker** y **Docker Compose** para manejar todas las dependencias y la ejecución del proyecto.

### 1. Construir y ejecutar el proyecto con Docker Compose:

Ejecuta el siguiente comando para construir y levantar los contenedores:

> docker-compose up --build

Este comando:

-   Construirá la imagen Docker del proyecto utilizando el **Dockerfile**.
-   Levantará el contenedor que ejecutará la aplicación de Django.

### 2. Ver la aplicación en tu navegador:

Una vez que el contenedor esté en ejecución, abre tu navegador y accede a la siguiente URL:

    http://localhost:8000

La API estará disponible en esta dirección, y podrás empezar a interactuar con los endpoints.

## Endpoints de la API

### 1. **GET /api/v1/vulnerabilities/**

Este endpoint consulta la API del NIST, obtiene las vulnerabilidades y las almacena en la base de datos local. Si ya existen en la base de datos, las actualiza.

-   **URL**: `/api/v1/vulnerabilities/`
-   **Método HTTP**: `GET`
-   **Respuesta**: Lista de vulnerabilidades obtenidas del NIST.

### 2. **POST /api/v1/vulnerabilities/fix/**

Este endpoint permite marcar como fixeadas una lista de vulnerabilidades, actualizando su estado en la base de datos local.

-   **URL**: `/api/v1/vulnerabilities/fix/`
-   **Método HTTP**: `POST`
-   **Cuerpo de la solicitud**:

> {
    "cve_ids": ["CCVE-1999-0082 " , "CVE-2022-67890"]
	}
-   **Respuesta**: Mensaje confirmando que las vulnerabilidades han sido marcadas como fixeadas.

### 3. **GET /api/v1/vulnerabilities/unfixed/**

Este endpoint devuelve todas las vulnerabilidades que **no han sido fixeadas**.

-   **URL**: `/api/v1/vulnerabilities/unfixed/`
-   **Método HTTP**: `GET`
-   **Respuesta**: Lista de vulnerabilidades no fixeadas.

### 4. **GET /api/v1/vulnerabilities/severity-summary/**

Este endpoint devuelve un resumen del número de vulnerabilidades por nivel de severidad (Critical, High, Medium, Low).

-   **URL**: `/api/v1/vulnerabilities/severity-summary/`
-   **Método HTTP**: `GET`
-   **Respuesta**: Un resumen por severidad de las vulnerabilidades almacenadas en la base de datos.

## Posibles errores

### Error: "permission denied" al correr Docker

Si obtienes un error relacionado con permisos, puede que tu usuario no esté en el grupo de Docker. Agrega tu usuario al grupo de Docker:

    sudo usermod -aG docker $USER